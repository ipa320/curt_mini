<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="curt_mini">

  <!-- path to package -->
  <xacro:arg name="path" default="$(find curt_mini)" />
  <xacro:arg name="use_sim_time" default="False" />
  <xacro:arg name="gazebo_controllers" default="$(arg path)/config/ros2_control_simulation.yaml" />
  <xacro:arg name="simulation" default="False" />
  <!-- Import ros2_control -->
  <xacro:include filename="$(find curt_mini)/models/curt_mini/ros2_control.xacro" />

  <!-- Include properties -->
  <xacro:include filename="$(find curt_mini)/models/curt_mini/properties.xacro" />

  <!-- Include sensors -->
  <xacro:include filename="$(find curt_mini)/models/curt_mini/sensors.xacro" />

  <link name="base_link">
    <inertial>
      <origin xyz="-0.0076959 -0.0021447 0.056616" rpy="0 0 0" />
      <mass value="9.6512" />
      <inertia ixx="0.036046" ixy="-1.6181E-05" ixz="-0.00088314" iyy="0.10986" iyz="-3.4695E-06" izz="0.12533" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="file://$(arg path)/models/curt_mini/meshes/base_link.STL" />
      </geometry>
      <material name="">
        <color rgba="0.5098 0.5098 0.54902 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="file://$(arg path)/models/curt_mini/meshes/base_link.STL" />
      </geometry>
    </collision>
  </link>

  <link name="front_right_wheel">
    <inertial>
      <origin xyz="-5.87030424270552E-15 0.00750997550383756 -5.38805111638396E-15" rpy="0 0 0" />
      <mass value="1.16081815267191" />
      <inertia ixx="0.00489876810873934" ixy="9.50165704321153E-19" ixz="-2.61848606081355E-08" iyy="0.00918238967794609" iyz="-1.71449040958554E-17" izz="0.00489885881575725" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="file://$(arg path)/models/curt_mini/meshes/Wheel_01 .STL" />
      </geometry>
      <material name="">
        <color rgba="0.298039215686275 0.298039215686275 0.298039215686275 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0.01 0" rpy="${PI / 2} 0 0" />
      <geometry>
        <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
      </geometry>
    </collision>
  </link>
  <joint name="front_right_motor" type="continuous">
    <origin xyz="0.259999999999997 -0.2140000002693 -0.0264914703891407" rpy="3.14159265358979 0 0" />
    <parent link="base_link" />
    <child link="front_right_wheel" />
    <axis xyz="0 -1 0" />
    <dynamics damping="1.0" />
    <limit effort="${max_effort}" velocity="${max_velocity}" />
  </joint>
  <xacro:wheel_transmissions prefix="front_right_motor" />

  <link name="front_left_wheel">
    <inertial>
      <origin xyz="2.97539770599542E-14 -0.00750997550383714 6.53053999766229E-14" rpy="0 0 0" />
      <mass value="1.16081815267191" />
      <inertia ixx="0.00489876810873935" ixy="3.91724337570418E-19" ixz="2.61848606067545E-08" iyy="0.00918238967794612" iyz="1.81861039773823E-17" izz="0.00489885881575728" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="file://$(arg path)/models/curt_mini/meshes/Wheel_02.STL" />
      </geometry>
      <material name="">
        <color rgba="0.298039215686275 0.298039215686275 0.298039215686275 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 -0.01 0" rpy="${PI / 2} 0 0" />
      <geometry>
        <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
      </geometry>
    </collision>
  </link>
  <joint name="front_left_motor" type="continuous">
    <origin xyz="0.259999999999997 0.2140000002693 -0.0264914703891414" rpy="3.14159265358979 0 0" />
    <parent link="base_link" />
    <child link="front_left_wheel" />
    <axis xyz="0 -1 0" />
    <dynamics damping="1.0" />
    <limit effort="${max_effort}" velocity="${max_velocity}" />
  </joint>
  <xacro:wheel_transmissions prefix="front_left_motor" />

  <link name="back_right_wheel">
    <inertial>
      <origin xyz="-3.25850457727483E-14 0.00750997550383728 5.8935495372836E-14" rpy="0 0 0" />
      <mass value="1.16081815267191" />
      <inertia ixx="0.00489876810873933" ixy="9.33801693307905E-19" ixz="-2.61848606033406E-08" iyy="0.00918238967794609" iyz="-1.82258288287945E-17" izz="0.00489885881575725" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="file://$(arg path)/models/curt_mini/meshes/Wheel_03.STL" />
      </geometry>
      <material name="">
        <color rgba="1 1 1 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0.01 0" rpy="${PI / 2} 0 0" />
      <geometry>
        <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
      </geometry>
    </collision>
  </link>
  <joint name="back_right_motor" type="continuous">
    <origin xyz="-0.259999999999997 -0.214000000269301 -0.02649147038914" rpy="3.14159265358979 0 0" />
    <parent link="base_link" />
    <child link="back_right_wheel" />
    <axis xyz="0 -1 0" />
    <dynamics damping="1.0" />
    <limit effort="${max_effort}" velocity="${max_velocity}" />
  </joint>
  <xacro:wheel_transmissions prefix="back_right_motor" />

  <link name="back_left_wheel">
    <inertial>
      <origin xyz="3.05311331771918E-15 -0.00750997550383753 2.26554885962571E-15" rpy="0 0 0" />
      <mass value="1.16081815267191" />
      <inertia ixx="0.00489876810873933" ixy="1.74686590365548E-18" ixz="2.61848606031113E-08" iyy="0.00918238967794607" iyz="1.56928180377104E-17" izz="0.00489885881575724" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="file://$(arg path)/models/curt_mini/meshes/Wheel_04.STL" />
      </geometry>
      <material name="">
        <color rgba="0.298039215686275 0.298039215686275 0.298039215686275 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 -0.01 0" rpy="${PI / 2} 0 0" />
      <geometry>
        <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
      </geometry>
    </collision>
  </link>
  <joint name="back_left_motor" type="continuous">
    <origin xyz="-0.259999999999997 0.2140000002693 -0.0264914703891408" rpy="3.14159265358979 0 0" />
    <parent link="base_link" />
    <child link="back_left_wheel" />
    <axis xyz="0 -1 0" />
    <dynamics damping="1.0" />
    <limit effort="${max_effort}" velocity="${max_velocity}" />
  </joint>
  <xacro:wheel_transmissions prefix="back_left_motor" />

  <!-- Import gazebo infos -->
  <xacro:if value="$(arg simulation)" >
    <xacro:include filename="$(find curt_mini)/models/curt_mini/gazebo.xacro" />
  </xacro:if>

</robot>